	<style>
		.btns {
			margin-left: 25%;
			margin-top: 50px;
		}

		.btn {
			display: inline-block;
			padding: .3em 1.2em;
			border-radius: 3px;
			background-color: teal;
			color: #fff;
			cursor: pointer;
		}

		.btn:nth-child(3) {
			background-color: red;
		}

		table.table {
			box-sizing: border-box;
			width: 50%;
			border-collapse: collapse;
			margin: 0 auto;

		}

		table.table td,
		table.table th {
			border: 1px solid #ccc;
			line-height: 2em;
			text-align: center;
		}

		table.table tr.current {
			background: #eeddee;
		}

		table.table1 {
			box-sizing: border-box;
			width: 50%;
			border-collapse: collapse;
			margin: 50px auto 0;
		}

		table.table1 td {
			border: 1px solid #cccccc;
			line-height: 3.5em;
			text-align: center;
			font-weight: bold;
		}

		.none {
			display: none;
		}

		.heng {
			width: 50%;
			height: 4px;
			border-bottom: 1px solid gray;
			margin: 30px auto;
		}
		.ls > input {
			width: 80%;
			height: 2em;
		}

	</style>
<div class="btns">
	<div class="btn" id="btn_add">添加</div>
	<div class="btn">批量导入</div>
	<div class="btn">批量删除</div>
</div>

<div class="forms">
	<form action="javascript:void(0)">
		<input type="hidden" name="id"/>
		<table class="table1">
			<tbody>
			<tr>
				<td>姓名</td>
				<td><input type="text" name="realname"></td>
			</tr>
			<tr>
				<td>手机</td>
				<td><input type="text" name="telephone"></td>
			</tr>
			<tr>
				<td width="150px">上传头像</td>
				<td><input type="button" value="点击上传"></td>
			</tr>
			<tr>
				<td width="60px">手机</td>
				<td><input type="text"></td>
			</tr>
			<tr>
				<td colspan="2"><input type="submit" value="提交"></td>
			</tr>
			</tbody>
		</table>
	</form>
	<div class="heng"></div>
</div>
<table class="table">
	<thead>
	<tr>
		<th width="60px">编号</th>
		<th width="200px">姓名</th>
		<th width="80px">头像</th>
		<th width="150px">手机</th>
		<th width="100px">操作</th>
	</tr>
	</thead>
	<tbody>
	<tr class="none">
		<td></td>
		<td></td>
		<td></td>
		<td></td>
		<td><a class="btn_del" href="javascript:void(0)">删除</a>
			<a class="btn_upd" href="javascript:void(0)">修改</a></td>
	</tr>
	</tbody>
</table>
	<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>

	<script>
	var $ = {
		//get方法
		get: function (url,handler) {
			var xhr = new XMLHttpRequest();
			xhr.open("get", url);
			xhr.responseType = "json";
			xhr.send();
			xhr.onreadystatechange = function () {
				if (this.readyState===4){
					if (this.status===200){
						var response = this.response;
						handler.call(this,response);
					}
				}
			};
		},
		//post提交
		post: function (url,data,handler,type) {
			var xhr = new XMLHttpRequest();
			xhr.open("post", url);
			xhr.responseType = "json";
			if (!type){
				type="application/x-www-form-urlencoded";
			}
			xhr.setRequestHeader("Content-Type", type);
			xhr.send(data);
			xhr.onreadystatechange = function () {
				if (this.readyState===4){
					if (this.status===200){
						var response = this.response;
						handler.call(this,response);
					}
				}
			}
		}
	};
</script>

<script>
	/*function handler() {
        alert(1);
    }
    // var btn_add = document.body.children[0];
    var btn_add = document.getElementById("btn_add");
        //给添加按钮绑定点击事件
        btn_add.onclick = handler;*/
	var btn_add = document.getElementById("btn_add");
	//获取tr
	var tbody = document.getElementsByTagName("tbody")[1];
	var basicurl = "http://134.175.154.93:6677";
	document.forms[0].onsubmit = function (event) {
		//1. 校验有效性
		//2.获取有效值
		var realname = document.querySelector("input[name=realname]").value;
		var telephone = document.querySelector("input[name=telephone]").value;
		var id = document.querySelector("input[name=id]").value;

		//3.与后台进行交互
		/* var xhr = new XMLHttpRequest();
         xhr.open("post", basicurl + "/customer/saveCustomerOrUpdateCustomer");
         xhr.responseType = "json";
         xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
         xhr.send(data);
         xhr.onreadystatechange = function () {
             if (this.readyState === 4) {
                 if (this.status === 200) {
                     initData();
                     alert(this.response.message);
                 }
             }
         };*/
		var url=basicurl + "/customer/saveCustomerOrUpdateCustomer";
		var data;
		if (id) {
			data = "id=" + id + "&realname=" + realname + "&telephone=" + telephone
		} else {
			data = "realname=" + realname + "&telephone=" + telephone
		}
		$.post(url,data,function (result) {
			initData();
			alert(result.message);
			console.log(data)
		});
		event.preventDefault();
	};


	// 为删除按钮绑定事件处理函数
	tbody.onclick = function (event) {
		if (event.target.nodeName === "A") {
			//0. 获取当前行的id
			switch (event.target.className) {
				case "btn_del":
					var id = event.target.parentNode.parentNode.children[0].innerText;

					var url =  basicurl + "/customer/deleteCustomerById";
					var data = "id=" + id;
					$.post(url,data,function (result) {
						initData();
						alert(result.message);
					});

					break;
				case "btn_upd":
					//1.将原有的信息放入表单中
					var id = event.target.parentNode.parentNode.children[0].innerText;
					var realname = event.target.parentNode.parentNode.children[1].innerText;
					var telephone = event.target.parentNode.parentNode.children[3].innerText;
					document.querySelector("input[name=realname]").value = realname;
					document.querySelector("input[name=telephone]").value = telephone;
					document.querySelector("input[name=id]").value = id;
					break;
			}
		}
	};
	//鼠标放上去当前行添加背景色
	tbody.onmouseover = function (event) {
		var target = event.target;
		if (target.nodeName == 'TD') {
			target.parentNode.className = "current"
		}
	};
	tbody.onmouseout = function (event) {
		var target = event.target;
		if (target.nodeName == 'TD') {
			target.parentNode.className = ""
		}
	};

	//获取tbody的第一个元素
	btn_add.onclick = function (event) {
		document.querySelector("input[name=realname]").value = "";
		document.querySelector("input[name=telephone]").value = "";
		document.querySelector("input[name=id]").value = "";
	};

	initData();

	//初始化数据
	function initData() {
		var url = basicurl + "/customer/findCustomerAll";
		$.get(url,function (response) {
			Array.prototype.slice.call(tbody.children, 0).forEach(function (item, index) {
				if (index !== 0) {//第一tr隐藏了,删除不了，因此要判断一下
					tbody.removeChild(item);
				}
			});
			response.data.forEach(function (item) {
				//创建新的一行
				var newTr = tbody.firstElementChild.cloneNode(true);
				newTr.children[0].innerText = item.id;
				//innerText获取或者设置一个元素的文本内容
				//innerHTML获取或者设置一个元素的html内容
				// newTr.children[1].innerHTML ="<strong>"+Math.random()+"</strong>";
				newTr.children[1].innerText = item.realname;
				newTr.children[3].innerText = item.telephone;
				newTr.children[2].innerText = item.photo;
				//此时newTr的类名为none,默认隐藏，因此修改其类名为“空”
				newTr.className = "";
				//追加新tr
				tbody.appendChild(newTr);
			})
		});
	}
</script>
